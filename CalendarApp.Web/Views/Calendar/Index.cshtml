@model CalendarApp.Web.Controllers.CalendarViewModel
@using CalendarApp.Domain.Entities
@{
    ViewData["Title"] = "Calendar";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <h2>Calendar - @Model.CurrentDate.ToString("MMMM yyyy")</h2>
        </div>
        <div class="col-auto">
            <div class="btn-group" role="group">
                <a href="@Url.Action("Index", "Calendar", new { date = Model.CurrentDate.AddMonths(-1) })" 
                   class="btn btn-outline-secondary">
                    <i class="bi bi-chevron-left"></i> Previous
                </a>
                <a href="@Url.Action("Index", "Calendar", new { date = DateTime.Now })" 
                   class="btn btn-outline-primary">
                    Today
                </a>
                <a href="@Url.Action("Index", "Calendar", new { date = Model.CurrentDate.AddMonths(1) })" 
                   class="btn btn-outline-secondary">
                    Next <i class="bi bi-chevron-right"></i>
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="calendar-container">
                <!-- Calendar Header -->
                <div class="calendar-grid">
                    <div class="calendar-header">Sunday</div>
                    <div class="calendar-header">Monday</div>
                    <div class="calendar-header">Tuesday</div>
                    <div class="calendar-header">Wednesday</div>
                    <div class="calendar-header">Thursday</div>
                    <div class="calendar-header">Friday</div>
                    <div class="calendar-header">Saturday</div>
                </div>

                <!-- Calendar Days -->
                <div class="calendar-grid">
                    @foreach (var day in Model.CalendarDays)
                    {
                        <div class="calendar-day @(day.IsCurrentMonth ? "current-month" : "other-month") @(day.IsToday ? "today" : "") @(day.IsWeekend ? "weekend" : "")">
                            <div class="calendar-day-header">
                                <span class="day-number">@day.Date.Day</span>
                                @if (day.IsToday)
                                {
                                    <span class="today-badge">Today</span>
                                }
                            </div>
                            <div class="calendar-events">
                                @foreach (var calendarEvent in day.Events.Take(3))
                                {
                                    <div class="calendar-event" style="background-color: @calendarEvent.Color; color: white;">
                                        <a href="@Url.Action("Details", "Calendar", new { id = calendarEvent.Id })" 
                                           class="event-link text-white text-decoration-none">
                                            <div class="event-time">@calendarEvent.StartTime.ToString("HH:mm")</div>
                                            <div class="event-title">@calendarEvent.Title</div>
                                        </a>
                                    </div>
                                }
                                @if (day.Events.Count > 3)
                                {
                                    <div class="more-events">
                                        <small>+@(day.Events.Count - 3) more</small>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.calendar-container {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    overflow: hidden;
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
}

.calendar-header {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    padding: 12px 8px;
    text-align: center;
    font-weight: 600;
    font-size: 0.9rem;
}

.calendar-day {
    border: 1px solid #dee2e6;
    min-height: 100px;
    padding: 8px;
    position: relative;
    background: white;
}

.calendar-day.other-month {
    background: #f8f9fa;
    opacity: 0.6;
}

.calendar-day.today {
    background: #e3f2fd;
}

.calendar-day.weekend {
    background: #fafafa;
}

.calendar-day-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.day-number {
    font-weight: 600;
    font-size: 0.9rem;
}

.today-badge {
    background: #2196f3;
    color: white;
    font-size: 0.7rem;
    padding: 2px 6px;
    border-radius: 10px;
}

.calendar-events {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.calendar-event {
    border-radius: 4px;
    padding: 2px 6px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: opacity 0.2s;
}

.calendar-event:hover {
    opacity: 0.8;
}

.event-link {
    display: block;
}

.event-time {
    font-weight: 600;
}

.event-title {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.more-events {
    text-align: center;
    color: #6c757d;
    font-size: 0.75rem;
    margin-top: 2px;
}

@@media (max-width: 768px) {
    .calendar-day {
        min-height: 80px;
        padding: 4px;
    }
    
    .calendar-header {
        padding: 8px 4px;
        font-size: 0.8rem;
    }
    
    .day-number {
        font-size: 0.8rem;
    }
    
    .calendar-event {
        font-size: 0.7rem;
        padding: 1px 4px;
    }
}
</style>